{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="vi">
  {% load static %}
<head>
  {% tailwind_css %}
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>{{Product.Title}}</title>
  <meta name="description" content="{{Product.Description}}" />
  <link rel="canonical" href="https://template-thuy-dung.vercel.app/" />

  <!-- Favicon -->
  <link rel="shortcut icon" href="/upload/website/icon.jpg" type="image/x-icon" />

  <!-- Open Graph (Facebook, Instagram, Zalo, …) -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="{{Product.Title}}" />
  <meta property="og:description" content="{{Product.Title}}" />
  <meta property="og:url" content="/video/{{Product.Slug}}" />
  <meta property="og:site_name" content="viewfullmedian" />
  <meta property="og:image" content="{{Product.Avatar.url}}" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <!-- Tùy chọn: nếu có nhiều ảnh, có thể thêm nhiều og:image -->

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{Product.Title}}" />
  <meta name="twitter:description" content="{{Product.Title}}" />
  <meta name="twitter:image" content="{{Product.Avatar.url}}" />
  <!-- Tuỳ chọn: @username nếu có -->
  <!-- <meta name="twitter:site" content="@youraccount" /> -->

  <!-- Structured Data (tùy chọn, giúp SEO) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body class="bg-black flex items-center justify-center min-h-screen relative">
  <div class="flex flex-col justify-center items-center gap-6">
      <span class="text-[30px] font-bold text-yellow-500 uppercase">
        ĐÁ GÀ Live
      </span>

      <!-- Các nút chọn kênh -->
      <div class="flex items-center gap-6">
        <button data-src="https://dagaxyz.online/hls/myStream.m3u8" class="p-3 rounded bg-red-500 font-bold uppercase hover:scale-125">Live 1</button>
        <button data-src="https://dagaxyz.online/hls/myStream.m3u8" class="p-3 rounded bg-green-500 font-bold uppercase hover:scale-125">Live 2</button>
        <button data-src="https://dagaxyz.online/hls/myStream.m3u8" class="p-3 rounded bg-green-500 font-bold uppercase hover:scale-125">Live 3</button>
        <button data-src="https://dagaxyz.online/hls/myStream.m3u8" class="p-3 rounded bg-green-500 font-bold uppercase hover:scale-125">Live 4</button>
      </div>

      <!-- Khung video -->
      <div class="flex justify-center items-center w-full lg:w-[800px] h-[300px] lg:h-[600px] bg-stone-700 rounded-md mt-5" style="">
        <video id="video" controls autoplay playsinline style="width:90%;max-width:960px;border-radius:12px;outline:none;background:#000;"></video>
      </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script>
    const video = document.getElementById('video');
    let hls;

    function playStream(url) {
      if (video.canPlayType('application/vnd.apple.mpegurl')) {
        // Safari/iOS
        video.src = url;
        video.play();
      } else if (Hls.isSupported()) {
        if (hls) {
          hls.destroy(); // reset nếu đang phát stream cũ
        }
        hls = new Hls({ maxBufferLength: 10 });
        hls.loadSource(url);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
      } else {
        video.outerHTML = '<p style="color:#fff">Trình duyệt không hỗ trợ HLS.</p>';
      }
    }

    // Gắn sự kiện cho các nút
    document.querySelectorAll("button[data-src]").forEach(btn => {
      btn.addEventListener("click", () => {
        const url = btn.getAttribute("data-src");
        playStream(url);
      });
    });

    // Mặc định load kênh 1
    playStream("http://dagaxyz.online/hls/kenh1.m3u8");
  </script>
</body>
</html>
